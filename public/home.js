(()=>{"use strict";function e(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var n=1,r=arguments[1];if(r&&"object"==typeof r&&null==r.nodeType&&!Array.isArray(r)){for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var o=r[a];"string"==typeof o?e.setAttribute(a,o):null!=o&&(e[a]=o)}n++}for(;n<arguments.length;n++)t(e,arguments[n]);return e}function t(e,n){if("string"==typeof n)e.appendChild(document.createTextNode(n));else if(null==n);else if(null!=n.nodeType)e.appendChild(n);else{if(!Array.isArray(n))throw new RangeError("Unsupported child node: "+n);for(var r=0;r<n.length;r++)t(e,n[r])}}function n(e){let t=new XMLHttpRequest,n=!1,r=new Promise(((r,a)=>{if(t.open(e.method,e.url,!0),t.addEventListener("load",(()=>{var e,o;if(!n)if(t.status<400)r(t.responseText);else{let n=t.responseText;n&&/html/.test(t.getResponseHeader("content-type"))&&(e=n,(o=document.createElement("div")).innerHTML=e,n=o.textContent.replace(/\n[^]*|\s+$/g,""));let r=new Error("Request failed: "+t.statusText+(n?"\n\n"+n:""));r.status=t.status,a(r)}})),t.addEventListener("error",(()=>{n||a(new Error("Network error"))})),e.headers)for(let n in e.headers)t.setRequestHeader(n,e.headers[n]);t.send(e.body||null)}));return r.abort=()=>{n||(t.abort(),n=!0)},r}function r(t){document.querySelector(".DocList").innerHTML="";const a=e("button",{class:"DocListButton"},"Create a new document");a.addEventListener("click",(()=>{!function(){let e=prompt("Name the new document","");const t=JSON.stringify({name:e});var a;e&&("collab-backend/docs",a=t,"application/json",n({url:"collab-backend/docs",method:"POST",body:a,headers:{"Content-Type":"application/json"}})).then((e=>r(JSON.parse(e))),(e=>report.failure(e)))}()}));let o=document.querySelector(".DocList").appendChild(e("ul",{class:"doclist"}));o.appendChild(a),t.forEach((t=>{const n=e("li");var r;n.appendChild(e("a",{"data-name":t.id},t.id+"("+(r=t.users)+" user"+(1==r?"":"s")+")")),n.appendChild(e("button",{class:"DocListButton","data-name":t.id},"delete")),o.appendChild(n)})),o.addEventListener("click",(e=>{var t;"A"==e.target.nodeName&&(location.pathname="/docs/"+e.target.getAttribute("data-name")),"BUTTON"==e.target.nodeName&&(t="collab-backend/docs/"+e.target.getAttribute("data-name"),n({url:t,method:"DELETE"})).then((e=>r(JSON.parse(e))),(e=>report.failure(e)))}))}("collab-backend/docs/",n({url:"collab-backend/docs/",method:"GET"})).then((e=>r(JSON.parse(e))),(e=>report.failure(e)))})();